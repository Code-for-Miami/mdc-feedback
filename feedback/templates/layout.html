<!DOCTYPE html>
<html class='no-js' lang='en'>
	<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
	<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
	<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
	<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
	<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->

<head>
  <meta charset="utf-8">

  <title>{% block page_title %}Feedback | {{request.endpoint }} {% endblock %}</title>
  <meta name="description" content="{% block meta_description %}{% endblock %}">
  <meta name="author" content="{% block meta_author %}{% endblock %}">

  <!-- Mobile viewport optimized: h5bp.com/viewport -->
  <meta name="viewport" content="width=device-width">

  <!-- favicon -->
  <link rel="icon" href="/static/favicon.ico" type="image/x-icon" />

    <!-- FONT
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
 <link href='//fonts.googleapis.com/css?family=Raleway:400,600,300' rel='stylesheet' type='text/css'>

  {% assets "css_all" %}
    <link rel="stylesheet" href="{{ ASSET_URL }}">
  {% endassets %}


</head>
<body class="{% block body_class %}{% endblock %}">
{% block body %}
{% with form=form  %}
{% include "nav.html" %}
{% endwith %}

<!-- nav active states -->
{% if active_page == 'Dashboard' %} 
			
			{% set navigation_bar = [
				('/admin/', 'Admin Panel'),
				('/create-survey/', 'Survey Builder')	
			] -%}
				
		{% elif active_page == 'Survey Builder' %}
		
			{% set navigation_bar = [
				
				('/', 'Dashboard'),
				('/admin/', 'Admin Panel')
					
			] -%}
			
		{% elif active_page == 'Admin' %}
		
			{% set navigation_bar = [
				
				('/', 'Dashboard'),
				('/create-survey/', 'Survey Builder')
									
			] -%}
		{% endif %}


<div class='row u-pull-left' id='breadcrumb'>

	<ul class='list-nav'>
						
		<li class='breadcrumb-text'>You're looking at:</li>
		<li id='breadcrumb-location' class='bold'>{{ title }}</li>		
	</ul>

</div>

<div class='row u-pull-right' id='breadcrumb-nav-parent'>
	
	<ul>
		
		<li class='breadcrumb-text'>Go back to:</li>
		
		{% for href, id in navigation_bar %}
		<li class='breadcrumb-nav'><a href='{{ href|e}}'>{{id|e}}</a></li>
		{% endfor %}
		
	</ul>
	
</div>


<div id='container' class="remodal-bg {% block content_class %}container-fluid{% endblock content_class %}">

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
  <div class="row">
    <div class="col-md-12">
      {% for category, message in messages %}
      <div class="alert alert-{{ category }}">
        <a class="close" title="Close" href="#" data-dismiss="alert">&times;</a>
       {{message}}
      </div><!-- end .alert -->
      {% endfor %}
    </div><!-- end col-md -->
  </div><!-- end row -->
  {% endif %}
{% endwith %}

{% block content %}{% endblock %}

</div><!-- end container -->

{% include "footer.html" %}


</body>
<!-- FIXME: move jquery into a bower and use grunt -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
<script type="text/javascript" src="/static/js/chart.min.js"></script>
<script type="text/javascript" src="/static/js/jquery.raty.js"></script>
<script type="text/javascript" src="/static/js/remodal.min.js"></script>

<script src="https://login.persona.org/include.js"></script>


{% assets "js_all" %}
    <script type="text/javascript" src="{{ ASSET_URL }}"></script>
{% endassets %}
{% block js %}{% endblock %}

{% if json_obj %}
<script type="application/json" id="jsondata">
{{ json_obj.test|safe }}
</script>
{% endif %}

<script type='text/javascript'>

{% if current_user.is_anonymous() or not current_user %}
var currentUser = null;
{% else %}
var currentUser = {{current_user.email|tojson|safe}};
{% endif %}

navigator.id.watch({
  loggedInUser: currentUser,
  onlogin: function(assertion) {
    // A user has logged in! Here you need to:
    // 1. Send the assertion to your backend for verification and to create a session.
    // 2. Update your UI.
    $.ajax({ /* <-- This example uses jQuery, but you can use whatever you'd like */
      type: 'POST',
      url: '{{ url_for("public.auth") }}', // This is a URL on your website.
      data: {assertion: assertion},
      success: function(res, status, xhr) {
        window.location.href = '/';
      },
      error: function(xhr, status, err) {
        alert("Login failure: " + err);
      }
    });
  },
  onlogout: function() {
    // A user has logged out! Here you need to:
    // Tear down the user's session by redirecting the user or making a call to your backend.
    // Also, make sure loggedInUser will get set to null on the next page load.
    // (That's a literal JavaScript null. Not false, 0, or undefined. null.)
    $.ajax({
      type: 'POST',
      url: '{{ url_for("public.logout") }}', // This is a URL on your website.
      success: function(res, status, xhr) {
        window.location.href = '{{ url_for("public.logout") }}';
      },
      error: function(xhr, status, err) { alert("Logout failure: " + err); }
    });
  }
});
var signinLink = $('.js-signin');
if (signinLink) {
  signinLink.on('click', function() {
    navigator.id.request();
  });
}
var signoutLink = $('.js-signout');
if (signoutLink) {
  signoutLink.on('click', function() {
    navigator.id.logout();
  });
}
</script>
<!-- end scripts -->
{% endblock %}
</html>
