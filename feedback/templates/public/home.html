{% extends "layout.html" %}
{% set active_page = 'Dashboard' %}
{% block content %}

<span id='api-health' class='hidden'>{{ api }}</span>

<div class="remodal" data-remodal-id="modal">

  <button data-remodal-action="close" class="remodal-close"></button>
  <h1 id='status'>Warning!<br>You can't undo this!</h1>
  <p></p>
  <br>
  <button data-remodal-action="confirm" class="remodal-confirm">OK, thanks!</button>

</div>

<section class='row' id='dashboard'>

	<div class='row twelve columns'>
		<h3>Permitting &amp; Inspection Center User Survey Metrics</h3>
	</div>

	<div class='six columns panel first-panel'>

		<!-- the data -->
		<p class='invisible'>{{ dash_obj[0].data.new_reviews }}</p>

		<!-- the content -->
		<div class='headline'>{{ dash_obj[0].title }}<a rel='tipsy' title='this is a tooltip' class='what-is-this u-pull-right tipsy-hook' href='#' id='s-submitted'><img class='' src='static/images/question_bk.png'></a></div>

		<div class='content-container'>
			<canvas id='myChart'></canvas>
		</div>

	</div>

	<div class='three columns panel'>

			<div class='headline'>{{ dash_obj[1].title }}<a rel='tipsy' title='this is a tooltip' class='what-is-this   u-pull-right tipsy-hook' href='#' id='s-rating'><img class='' src='static/images/question_bk.png'></a></div>

			<div class='content-container'>
				<div id='star-rating'>
					<!-- data & display -->
					<p class='invisible'>{{ dash_obj[1].data }}</p>
				</div>
				<p class='label'>Visitors to the PIC are rating their experience as {{ dash_obj[1].data }} out of seven stars.</p>
			</div>

		</div>

	<div class='three columns panel last-panel'>

		<!-- the content -->
		<div class='headline'><a rel='tipsy' title='this is a tooltip' class='what-is-this u-pull-right tipsy-hook' href='#' id='s-type'><img class='' src='static/images/question_bk.png'></a></div>
		<div class='content-container'>
			<canvas id='surveyChart'></canvas>
		</div>

	</div>

<!-- merge conflict began here -->
  <div class='four columns panel first-panel'>
    <div class='headline'>Respondents by Role<a rel='tipsy' title='this is a tooltip' class='what-is-this u-pull-right tipsy-hook' href='#' id='s-role'><img class='' src='static/images/question_bk.png'></a></div>
    <div class='content-container'>
			<canvas id='s-role-chart'></canvas>
		</div>
  </div>

  <div class='four columns panel'>
    <div class='headline'>Visitors' ability to complete a task<a class='what-is-this u-pull-right tipsy-hook' href='#' id='s-complete'><img class='' src='static/images/question_bk.png'></a></div>
    <div class='content-container'>
			<canvas id='s-complete-chart'></canvas>
		</div>
  </div>

  <div class='four columns panel last-panel'>
    <div class='headline'>{{ dash_obj[13].title }}<a class='what-is-this u-pull-right' href='#' id='s-purpose'><img class='' src='static/images/question_bk.png'></a></div>

    <div class='content-container'>
			<canvas id='s-purpose-chart'></canvas>
		</div>

  </div>

  <div class='four columns panel first-panel'>
    <div class='headline'>Satisfaction by Language<a rel='tipsy' title='this is a tooltip' class='what-is-this u-pull-right tipsy-hook' href='#' id='s-ratings-lang'><img class='' src='static/images/question_bk.png'></a></div>

    <li id='rate-en' class='invisible'>{{ dash_obj[14].data.en }}</li><br />
    <li id='rate-es' class='invisible'>{{ dash_obj[14].data.es }}</li><br />

    <div class='content-container'>
			<div id='s-lang-rate-en'>English:<br> </div><br>
			<div id='s-lang-rate-es'>Spanish:<br> </div>
		</div>

  </div>

  <div class='four columns panel'>
  	 <div class='headline'>Satisfaction by Purpose<a rel='tipsy' title='this is a tooltip' class='what-is-this   u-pull-right tipsy-hook' href='#' id='s-ratings-purpose'><img class='' src='static/images/question_bk.png'></a></div>

		  <li id='rate-permit' class='invisible'>{{ dash_obj[14].data.p1 }}</li>
      <li id='rate-inspect' class='invisible'>{{ dash_obj[14].data.p2 }}</li>
      <li id='rate-review' class='invisible'>{{ dash_obj[14].data.p3 }}</li>
      <li id='rate-liens' class='invisible'>{{ dash_obj[14].data.p4 }}</li>
      <li id='rate-cu' class='invisible'>{{ dash_obj[14].data.p5 }}</li>

      <div class='content-container'>

	      <div class='six columns'>
					<div id='s-purpose-rate-permit'>Apply for a Permit: <br></div><br>
					<div id='s-purpose-rate-inspect'>Meet w/ Inspector: <br></div><br>
					<div id='s-purpose-rate-review'>Meet w/ Plan Reviewer: <br></div>
	      </div>
	      <div class='six columns'>
					<div id='s-purpose-rate-liens'>Violations/Liens: <br></div><br>
					<div id='s-purpose-rate-cu'>CU/CO: <br></div>
	      </div>

			</div>

  </div>

  <div class='four columns panel last-panel'>
	  	 <div class='headline'>Satisfaction by Role<a rel='tipsy' title='this is a tooltip' class='what-is-this   u-pull-right tipsy-hook' href='#' id='s-ratings-role'><img class='' src='static/images/question_bk.png'></a></div>

			<div class='content-container'>

				<div class='six columns'>

					<div id='s-role-rate-permit'>Contractor: </br></div><br />
					<div id='s-role-rate-inspect'>Architect: <br></div><br />
					<div id='s-role-rate-review'>Permit Consultant: <br></div>

				</div>

				<div class='six columns'>

					<div id='s-role-rate-lien'>Homeowner: <br></div><br />
					<div id='s-role-rate-cu'>Business Owner: <br></div>

				</div>

			</div>

			<li id='role-rate-permit' class='invisible'>{{ dash_obj[14].data.contractor }}</li>
      <li id='role-rate-inspect' class='invisible'>{{ dash_obj[14].data.architect }}</li>
      <li id='role-rate-review' class='invisible'>{{ dash_obj[14].data.permitconsultant }}</li>
      <li id='role-rate-lien' class='invisible'>{{ dash_obj[14].data.homeowner }}</li>
      <li id='role-rate-cu' class='invisible'>{{ dash_obj[14].data.bizowner }}</li>

  </div>

</section> <!-- close row -->

<section class='row' id='permitting'>

	<div class='row twelve columns'><h3>Permit Metrics</h3></div>

	<div class='twelve columns panel first-panel'>

			<div class='headline'>Master building permits opened per month<a rel='tipsy' title='this is a tooltip' class='what-is-this   u-pull-right tipsy-hook' href='#' id='p-monthly'><img class='' src='static/images/question_bk.png'></a></div>

			<div class='content-container'>
				<canvas id='openPermits'></canvas>
			</div>

		</div>

  
  <div class='twelve columns panel first-panel last-panel'>
      
      <div class='headline'>
        Trade permits, issued same-day v. total issued <!-- same day trade permits -->
        <a rel='tipsy' title='' class='what-is-this u-pull-right tipsy-hook' href='#' id='p-same-day'><img class='' src='static/images/question_bk.png'></a>
      </div>
      
      <div class='content-container twelve-columns'>
        
        <ul class='hidden'>
          <li id='plumbing-data'>{{ '%0.2f'| format(dash_obj[6].data.PLUM.percent) }}</li>
          <li id='building-data'>{{ '%0.2f'| format(dash_obj[6].data.BLDG.percent) }}</li>
          <li id='fire-data'>{{ '%0.2f'| format(dash_obj[6].data.FIRE.percent) }}</li>
          <li id='electrical-data'>{{ '%0.2f'| format(dash_obj[6].data.ELEC.percent) }}</li>
          <li id='zoning-data'>{{ '%0.2f'| format(dash_obj[6].data.ZIPS.percent) }}</li>
        </ul>
        
        <ul id='centered-list'>
          
          <li>
            
            <canvas id='p-plumbing'></canvas>
            <p>Plumbing</p>
            
          </li>
          
          <li>
            
            <canvas id='p-building'></canvas>
            <p>Building</p>
            
          </li>
          
          <li>
            <canvas id='p-fire'></canvas>
            <p>Fire</p>
            
          </li>
          
          <li>
            <canvas id='p-electrical'></canvas>
            <p>Electrical</p>
          </li>
          
          <li>
            <canvas id='p-zoning'></canvas>
            <p>Zoning</p>
          </li>
        
        </ul>
      </div>
      
    </div>
    
  <div class='twelve columns'>
      
    <div class='four columns panel double-height first-panel'>
      <div class='headline'>
        Time to issuance for commercial permits
        <a rel='tipsy' title='this is a tooltip' class='what-is-this   u-pull-right tipsy-hook' href='#' id='p-commercial-issuance'><img class='' src='static/images/question_bk.png'></a>
      </div>
      <div class='content-container'>
        <p class='bold panel-header vertical-center-35m'>New commercial construction and additions:</p>
        <li>{{ dash_obj[3].data.nc.val }} days on average</li>
        <li>{{ dash_obj[3].data.nc.min }} days min.</li>
        <li class='last-list'>{{ dash_obj[3].data.nc.max }} days max.</li>
        
        
        <p class='bold panel-header'>Renovations, alterations or repairs:</p>
        <li>{{ dash_obj[3].data.rc.val }} days on average</li>
        <li>{{ dash_obj[3].data.rc.min }} days min.</li>
        <li class='last-list'>{{ dash_obj[3].data.rc.max }} days max.</li>
        
        
        <p class='bold panel-header'>Signs (Non-Electric):</p>
        <li>{{ dash_obj[3].data.s.val }} days on average</li>
        <li>{{ dash_obj[3].data.s.min }} days min.</li>
        <li class='last-list'>{{ dash_obj[3].data.s.max }} days max.</li>

      </div>
      
    </div>
    
    <div class='eight columns panel double-height last-panel'>
      <div class='headline'>
        <!-- {{ dash_obj[4].title }} --> Time to issuance for residential permits
        <a rel='tipsy' title='this is a tooltip' class='what-is-this   u-pull-right tipsy-hook' href='#' id='p-residential-issuance'><img class='' src='static/images/question_bk.png'></a>
      </div>
      <div class='content-container'>
        
        <div class='six columns vertical-center-35'>
        
          <p class='bold panel-header'>New residential construction:</p>
          <li>{{ dash_obj[4].data.nr.val }} days on average</li>
          <li>{{ dash_obj[4].data.nr.min }} days min.</li>
          <li class='last-list'>{{ dash_obj[4].data.nr.max }} days max.</li>
          
          
          <p class='bold panel-header'>Renovations, alterations or repairs:</p>
          <li>{{ dash_obj[4].data.rr.val }} days on average</li>
          <li>{{ dash_obj[4].data.rr.min }} days min.</li>
          <li class='last-list'>{{ dash_obj[4].data.rr.max }} days max.</li>
          
          <p class='bold panel-header'>Swimming pools:</p>
          <li>{{ dash_obj[4].data.p.val }} days on average</li>
          <li>{{ dash_obj[4].data.p.min }} days min.</li>
          <li class='last-list'>{{ dash_obj[4].data.p.max }} days max.</li>
        
        </div>
        
        <div class='six columns vertical-center-35'>
        
          <p class='bold panel-header'>Fences and walls:</p>
          <li>{{ dash_obj[4].data.f.val }} days on average</li>
          <li>{{ dash_obj[4].data.f.min }} days min.</li>
          <li class='last-list'>{{ dash_obj[4].data.f.max }} days max.</li>
          
          <p class='bold panel-header'>Screen enclosures:</p>
          <li>{{ dash_obj[4].data.e.val }} days on average</li>
          <li>{{ dash_obj[4].data.e.min }} days min.</li>
          <li class='last-list'>{{ dash_obj[4].data.e.max }} days max.</li>
        </div>
        
      </div>
      
    </div>
    
  </div>

	<div class='twelve columns'>

    <div class='eight columns panel first-panel'>
      <div class='headline'>{{ dash_obj[9].title }}<a rel='tipsy' title='this is a tooltip' class='what-is-this   u-pull-right tipsy-hook' href='#' id='p-type'><img class='' src='static/images/question_bk.png'></a></div>
      <div class='content-container'>
         <canvas id='permitTypeChart'>
      </div>
      
    </div>

    <div class='four columns panel last-panel'>
      <div class='headline'>
        {{ dash_obj[11].title }}
        <a rel='tipsy' title='this is a tooltip' class='what-is-this   u-pull-right tipsy-hook' href='#' id='p-master'><img class='' src='static/images/question_bk.png'></a>
      </div>
      <div class='content-container'>
        <p class="huge bold">{{ '{0:,}'.format(dash_obj[11].data.val) }}</p>
        <p>Versus the same period a year ago:
          {% if dash_obj[11].data.yoy > 0 %}
          <span class='bold green'>Up
          {% else %}
          <span class='bold red'>Down
          {% endif %}
          {{ '%0.2f'| format(dash_obj[11].data.yoy|float) }}%
          </span>
        </p>
      </div>
      
    </div>

</section> <!-- close row -->

<section class='row' id='regulation'>

	<div class='row twelve columns'><h3>Neighborhood Compliance</h3></div>

	<div class='row twelve columns panel'>

		<div class='headline'>
      Complaints &amp; violations cases opened, per month
      <a rel='tipsy' title='this is a tooltip' class='what-is-this   u-pull-right tipsy-hook' href='#' id='v-monthly'><img class='' src='static/images/question_bk.png'></a>
    </div>
		<div class='content-container'>
			<canvas id='violations'></canvas>
		</div>
		
	</div>

	<div class='row twelve columns'>

		<div class='six columns panel first-panel double-height'>

			<div class='headline'>Violations by location, current month to date<a rel='tipsy' title='this is a tooltip' class='what-is-this   u-pull-right tipsy-hook' href='#' id='v-closed'><img class='' src='static/images/question_bk.png'></a></div>
			<div class='content-container'>
				<div id='leaflet'></div>
			</div>
			
		</div>

		<div class='six columns panel last-panel double-height'>

			<div class='headline'>Violations by location, previous month<a rel='tipsy' title='this is a tooltip' class='what-is-this   u-pull-right tipsy-hook' href='#' id='v-liens'><img class='' src='static/images/question_bk.png'></a></div>
			<div class='content-container'>
				<div id='leaflet-lein'></div>
			</div>
			
		</div>

	</div>

	<div class='row twelve columns panel double-height'>

			<div class='headline'>Top 20 Violations by Type, to date in 2015<a rel='tipsy' title='this is a tooltip' class='what-is-this   u-pull-right tipsy-hook' href='#' id='v-type'><img class='' src='static/images/question_bk.png'></a></div>
			<div class='content-container'>
				<canvas id='viotype'></canvas>
			</div>
			<p class='details invisible-button'><a href="{{ url_for('dashboard.violations_detail') }}">View Complete Dataset</a></p>

		</div>
</section> <!-- close row -->

{% endblock %}

{% macro lifespan_panel(title='', val=0, lastpanel=True) -%}

    <div class='four columns panel{% if lastpanel==True %} last-panel{% endif %}'>

      <div class='headline'>{{ title }}<a class='what-is-this u-pull-right' href='#'><img class='' src='static/images/question_bk.png'></a></div>

      <div class='content-container vertical-center-35'>
        <p class='huge bold'>{{ val.val }} days</p>
        <p>Max: {{ val.max }}</p>
        <p>Min: {{ val.min }}</p>

      </div>
      
    </div>
{%- endmacro %}
